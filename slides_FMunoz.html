<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
  <head>
    <title>Estimation of the spread-rate of epidemics</title>
    <meta charset="utf-8" />
    <meta name="author" content="Facundo Muñoz, A. Mercier, R. Lancelot, J. Cauchard facundo.munoz@cirad.fr   famuvie" />
    <link href="libs/remark-css/default.css" rel="stylesheet" />
    <link href="libs/remark-css/default-fonts.css" rel="stylesheet" />
    <link rel="stylesheet" href="libs/font-awesome/css/fontawesome-all.min.css" type="text/css" />
    <link rel="stylesheet" href="cirad.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# Estimation of the spread-rate of epidemics
## African Swine Fever in Belgian wild boar populations
### <a href='https://cirad-astre.github.io/ASF-Symposium-BEL/#1'>Facundo Muñoz</a>, A. Mercier, R. Lancelot, J. Cauchard<br/><a href="mailto:facundo.munoz@cirad.fr" class="email">facundo.munoz@cirad.fr</a><br/><i class="fab fa-twitter"></i> <i class="fab fa-github"></i> famuvie<br /><img src="img/CirBlanc_L230px.png" style="width: 25%" align="top" /> <img src="img/anses_inv.png" style="width: 25%" align="top"/>
### AESA Symposium. Liège, May 2019

---






background-image: url(img/progress_cases.gif)
background-size: contain
&lt;!-- TODO: Include a img/qr_slides_inv.png to the online published
html version within the submitted pdf version --&gt;

---
class: large

# Objectives


1. Spread-rate __estimates__

1. __Methodology__

1. __Uncertainty__ assessment

1. __Limitations__ and lines of work


---
class: inverse, center, middle

# Estimates

---
# Average spread-rate estimate

.pull-left[
![](asf_spread_BEL_files/figure-latex/average-spread-rate-plot-1.png)
]

.pull-right[
Mean: __2.9 km/mo__

89% MCI: __(2.2, 3.4)__
]


---
# Local variation in spread-rate

- Range from __0.5__ to __7.7 km/mo__

- __66 %__ of the estimates below the average

![:scale 70%](asf_spread_BEL_files/figure-latex/fig:mc-marginal-density-1.png)


---
background-image: url(asf_spread_BEL_files/figure-latex/sr-point-avg-sd-1.png)
background-size: contain
# Spatial local estimates


---
# Large estimates, large uncertainties

- &lt;font color="#F8766D"&gt;Highest&lt;/font&gt; local estimate: __7.7 (2.4, 17.6) km/mo__

- &lt;font color="#00BA38"&gt;Average&lt;/font&gt; local estimate: __2.9 (1.8, 4.3) km/mo__

![:scale 70%](asf_spread_BEL_files/figure-latex/mc-density-locations-1.png)


---
class: inverse, center, middle

# Methodology

---
# Outline

1. Filter __earliest observations__

2. Interpolate surface of __first-invasion date__

3. Derive surface of __spread rate__


---

# 1: Earliest observations

.pull-left[
  ![](asf_spread_BEL_files/figure-latex/min-neigh-1.png)
]

.pull-right[
- Only the first observed cases in a __neighbourhood__ are relevant

- __Neighbouring-tolerance parameter__: how far apart two cases
can be to still be considered at the _same place_?

]
- Assign the __earliest observed date__ in the neighbourhood to each 
_representative_ location


---
# 2: Date of first-invasion surface

- Fit __Thin-plate regression splines__ model to _earliest observations_ + Interpolate observations


![](img/fa_surf.png)


---
# 3: Derive surface of spread-rate

- __Inverse slope__ of first-invasion date surface

![:scale 70%](asf_spread_BEL_files/figure-latex/plot-fasr-estimate-1.png)


---
class: inverse, center, middle

# Uncertainty assessment


---
# Sources of variation

- __Data__

    - Missed observations
    
    - Precision of (spatio-temporal) location
    
    - Heterogeneous protocols and definitions of case
    
    - ...
    
- Tuning __parameters__ of the method

    - Neighbouring-tolerance parameter
    

---
# Monte Carlo approach

## Introduce __perturbations__ into data and parameters and reproduce... __many times__ (999)

![](/home/facu/Work/Proyectos/asf_spread_belgium/reports/slides_FMunoz_files/figure-html/MC-circle-1.png)&lt;!-- --&gt;
Spatial coordinates: uniformly shifted within a radius of __1 km__

![](/home/facu/Work/Proyectos/asf_spread_belgium/reports/slides_FMunoz_files/figure-html/MC-time-1.png)&lt;!-- --&gt;
Observation dates: __± 1 day__ with prob. 1/4

![](/home/facu/Work/Proyectos/asf_spread_belgium/reports/slides_FMunoz_files/figure-html/MC-neigh-1.png)&lt;!-- --&gt;
Neighbouring-tolerance distance: Normally distributed __between 400 and 1200 m__ at 99.9 %


---
# Monte Carlo results

- 999 potential estimates of spread rate

![:scale 70%](asf_spread_BEL_files/figure-latex/uq-sample-mcmc-sims-1.png)


---
# Interpretation and processing

- A sample from a __distribution of spread-rate surfaces__, accounting
for input uncertainty

- Compute __summaries__ such as mean, sd, quantiles of __any
function__ of the estimates

---
class: inverse, center, middle

# Limitations and lines of work

---

## The __interpolation__ with Thin-plate splines regression is __not optimal__

- particularly around extremes (which do not need smoothing)

- the level of smoothing is optimised for the observed values (not
for their slopes)

---

## The current method does not account for __explanatory covariates__

- Can't leverage potentially informative __risk factors__

- Need to interpret variations in spread rate at a later stage

- Not really a statistical model


---
# Work in progress

- __Augment__ the base of splines with a few __cones__ (sharp
vertices)

- Their number and location are estimated in a __statistical model__,
with supplementary __covariates__


![](img/wip_breakpoints.png)

&lt;!-- --- --&gt;
&lt;!-- # Work in progress --&gt;

&lt;!-- - Develop a Markov Chain Monte Carlo algorithm to sample from the model --&gt;

&lt;!-- $$ --&gt;
&lt;!-- \begin{aligned} --&gt;
&lt;!-- y_i &amp; \sim \mathcal N(\delta_{x[i]}, \sigma) \\ --&gt;
&lt;!-- \nu_x &amp; = 1/|\nabla\delta_x| --&gt;
&lt;!-- \end{aligned} --&gt;
&lt;!-- $$ --&gt;

&lt;!-- where `\(\delta_x\)` is the date of first-invasion surface and the spread --&gt;
&lt;!-- rate surface `\(\nu_x\)` is modelled in terms of the splines base and --&gt;
&lt;!-- other available covariates --&gt;

---
class: left, middle, inverse

![:scale 20%](img/CirBlanc_L230px.png)

&lt;!-- &lt;img src=\"../img/CirBlanc_L230px.png\" style=\"width: 25%\" align=\"top\" /&gt; --&gt;

# Thanks!

.small[
&lt;!-- &lt;a href="http://twitter.com/famuvie"&gt; --&gt;
  &lt;i class="fab fa-twitter"&gt;&lt;/i&gt;&amp;nbsp; famuvie&lt;br&gt;
&lt;!-- &lt;/a&gt;&lt;br&gt; --&gt;
&lt;!-- &lt;a href="http://github.com/famuvie"&gt; --&gt;
  &lt;i class="fab fa-github"&gt;&lt;/i&gt;&amp;nbsp; famuvie&lt;br&gt;
&lt;!-- &lt;/a&gt;&lt;br&gt; --&gt;
&lt;a href="mailto:facundo.munoz@cirad.fr"&gt;
  &lt;i class="fa fa-paper-plane fa-fw"&gt;&lt;/i&gt;&amp;nbsp; facundo.munoz@cirad.fr
&lt;/a&gt;
]

![:scale 25%](img/qr_slides_inv.png)

.tiny[
Slides created with [remark.js](http://remarkjs.com/) and the R package [**xaringan**](https://github.com/yihui/xaringan), available at https://cirad-astre.github.io/ASF-Symposium-BEL/
]


---
class: inverse, center, middle

# Context

---

&lt;!-- # Veille Sanitaire Internationale (VSI) --&gt;

![:scale 40%](img/logo-vsi.png)

- Part of the French Platform on Animal Health (__Plateforme ESA__) since
Nov. 2013

- Coordinated by __Cirad__ (Alizé Mercier) and __Anses__ (Julien Cauchard)

- Identification, follow-up and Analysis of hazards for the (wide-sense) 
animal health in the French territory

- Production of actionable information for 
    - __risk assessment__ (Anses)
    - __risk management__ (DGAL - Min. of Agriculture)
    - __dissemination__ in industry


---
background-image: url(img/map-asf-europe.png)
background-size: contain

# Following ASF since 2014
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script src="macros.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();</script>

<script>
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
